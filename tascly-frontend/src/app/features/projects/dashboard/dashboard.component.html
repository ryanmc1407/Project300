<div class="dashboard-container">
    <!-- Header -->
    <header class="dashboard-header">
        <div class="header-content">
            <div class="header-left">
                <h1>Tascly</h1>
                @if (currentUser()) {
                <p class="welcome-text">Welcome back, <strong>{{ currentUser()!.username }}</strong></p>
                }
            </div>
            <div class="header-right">
                <button class="btn-secondary" (click)="onLogout()">
                    <span>Logout</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="dashboard-main">
        <div class="content-wrapper">
            <!-- Page Title and Actions -->
            <div class="page-header">
                <h2>My Projects</h2>
                <button class="btn-primary" (click)="toggleCreateForm()">
                    @if (showCreateForm()) {
                    <span>‚úï Cancel</span>
                    } @else {
                    <span>+ New Project</span>
                    }
                </button>
            </div>

            <!-- Error Message -->
            @if (errorMessage()) {
            <div class="error-alert">{{ errorMessage() }}</div>
            }

            <!-- Create Project Form -->
            @if (showCreateForm()) {
            <div class="create-form-card">
                <h3>Create New Project</h3>
                <form [formGroup]="createProjectForm" (ngSubmit)="onCreateProject()">
                    <div class="form-group">
                        <label for="name">Project Name</label>
                        <input id="name" type="text" formControlName="name" placeholder="Enter project name"
                            [class.error]="hasError('name', 'required') || hasError('name', 'minlength')" />
                        @if (hasError('name', 'required')) {
                        <span class="error-message">Project name is required</span>
                        }
                        @if (hasError('name', 'minlength')) {
                        <span class="error-message">Name must be at least 3 characters</span>
                        }
                    </div>

                    <div class="form-group">
                        <label for="description">Description (Optional)</label>
                        <textarea id="description" formControlName="description" placeholder="Enter project description"
                            rows="3"></textarea>
                    </div>

                    <button type="submit" class="btn-primary" [disabled]="isLoading()">
                        @if (isLoading()) {
                        <span>Creating...</span>
                        } @else {
                        <span>Create Project</span>
                        }
                    </button>
                </form>
            </div>
            }

            <!-- Projects Grid -->
            @if (isLoading() && projects().length === 0) {
            <div class="loading-state">
                <div class="spinner"></div>
                <p>Loading projects...</p>
            </div>
            } @else if (projects().length === 0) {
            <div class="empty-state">
                <div class="empty-icon">üìÅ</div>
                <h3>No projects yet</h3>
                <p>Create your first project to get started!</p>
            </div>
            } @else {
            <div class="projects-grid">
                @for (project of projects(); track project.id) {
                <div class="project-card">
                    <div class="project-header">
                        <h3>{{ project.name }}</h3>
                        <span class="project-date">{{ project.createdAt | date: 'MMM d, y' }}</span>
                    </div>
                    @if (project.description) {
                    <p class="project-description">{{ project.description }}</p>
                    } @else {
                    <p class="project-description no-description">No description provided</p>
                    }
                    <div class="project-actions">
                        <button class="btn-link">View Details ‚Üí</button>
                    </div>
                </div>
                }
            </div>
            }
        </div>
    </main>
</div>